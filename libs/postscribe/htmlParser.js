!function(){var e=function(){var t,e={},n=this.document.createElement("div");return t="<P><I></P></I>",n.innerHTML=t,e.tagSoup=n.innerHTML!==t,n.innerHTML="<P><i><P></P></i></P>",e.selfClose=2===n.childNodes.length,e}(),s=/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,r=/^<\/([\-A-Za-z0-9_]+)[^>]*>/,u=/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,c=/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i,i=!1;function t(f,g){for(var t in f=f||"",g=g||{},e)e.hasOwnProperty(t)&&(g.autoFix&&(g["fix_"+t]=!0),g.fix=g.fix||g["fix_"+t]);function l(t){f=t+f}var o=document.createElement("div"),n={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},a={comment:function(){var t=f.indexOf("--\x3e");if(0<=t)return{content:f.substr(4,t-1),length:t+3}},endTag:function(){var t=f.match(r);if(t)return{tagName:t[1],length:t[0].length}},atomicTag:function(){var t=a.startTag();if(t){var e=f.slice(t.length);if(e.match(new RegExp("</\\s*"+t.tagName+"\\s*>","i"))){var n=e.match(new RegExp("([\\s\\S]*?)</\\s*"+t.tagName+"\\s*>","i"));if(n)return{tagName:t.tagName,attrs:t.attrs,content:n[1],length:n[0].length+t.length}}}},startTag:function(){if(-1===f.indexOf(">"))return null;var t=f.match(s);if(t){var a={},r={},i=t[2];return t[2].replace(u,function(t,e){if(arguments[2]||arguments[3]||arguments[4]||arguments[5])if(arguments[5])a[arguments[5]]="",r[e]=!0;else{var n=arguments[2]||arguments[3]||arguments[4]||c.test(e)&&e||"";a[e]=function(t){return"string"==typeof t&&-1!==t.indexOf("&")?(o.innerHTML=t,o.textContent||o.innerText||t):t}(n)}else a[e]=null;i=i.replace(t,"")}),{tagName:t[1],attrs:a,booleanAttrs:r,rest:i,unary:!!t[3],length:t[0].length}}},chars:function(){var t=f.indexOf("<");return{length:0<=t?t:f.length}}},m=function(){for(var t in n)if(n[t].test(f)){i&&console.log("suspected "+t);var e=a[t]();return e?(i&&console.log("parsed "+t,e),e.type=e.type||t,e.text=f.substr(0,e.length),f=f.slice(e.length),e):null}};return g.fix&&function(){var e=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,n=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i,a=[];a.last=function(){return this[this.length-1]},a.lastTagNameEq=function(t){var e=this.last();return e&&e.tagName&&e.tagName.toUpperCase()===t.toUpperCase()},a.containsTagName=function(t){for(var e,n=0;e=this[n];n++)if(e.tagName===t)return!0;return!1};function r(t){return t&&"startTag"===t.type&&(t.unary=e.test(t.tagName)||t.unary,t.html5Unary=!/\/>$/.test(t.text)),t}function i(){var t=a.pop();l("</"+t.tagName+">")}var o=m,s={startTag:function(t){var e=t.tagName;"TR"===e.toUpperCase()&&a.lastTagNameEq("TABLE")?(l("<TBODY>"),c()):g.fix_selfClose&&n.test(e)&&a.containsTagName(e)?a.lastTagNameEq(e)?i():(l("</"+t.tagName+">"),c()):t.unary||a.push(t)},endTag:function(t){a.last()?g.fix_tagSoup&&!a.lastTagNameEq(t.tagName)?i():a.pop():g.fix_tagSoup&&u()}},u=function(){o(),c()},c=function(){var t=function(){var t=f,e=r(o());return f=t,e}();t&&s[t.type]&&s[t.type](t)};m=function(){return c(),r(o())}}(),{append:function(t){f+=t},readToken:m,readTokens:function(t){for(var e;e=m();)if(t[e.type]&&!1===t[e.type](e))return},clear:function(){var t=f;return f="",t},rest:function(){return f},stack:[]}}for(var n in t.supports=e,t.tokenToString=function(t){var e={comment:function(t){return"\x3c!--"+t.content},endTag:function(t){return"</"+t.tagName+">"},atomicTag:function(t){return i&&console.log(t),e.startTag(t)+t.content+e.endTag(t)},startTag:function(t){var e="<"+t.tagName;for(var n in t.attrs){e+=" "+n;var a=t.attrs[n];void 0!==t.booleanAttrs&&void 0!==t.booleanAttrs[n]||(e+='="'+(a?a.replace(/(^|[^\\])"/g,'$1\\"'):"")+'"')}return t.rest&&(e+=t.rest),e+(t.unary&&!t.html5Unary?"/>":">")},chars:function(t){return t.text}};return e[t.type](t)},t.escapeAttributes=function(t){var e={};for(var n in t){var a=t[n];e[n]=a&&a.replace(/(^|[^\\])"/g,'$1\\"')}return e},e)t.browserHasFlaw=t.browserHasFlaw||!e[n]&&n;this.htmlParser=t}();